{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst keyAPI = \"54842065-4aabfdb1463b75fbfdf76b66f\";\nconst urlAPI = \"https://pixabay.com/api/\";\n\nexport const pageLimit = 15;\n\nexport async function getImagesByQuery(query, page = 1) {\n    const response = await axios.get(urlAPI, {\n        params: {\n            \"key\": keyAPI,\n            \"q\": `${query}`,\n            \"image_type\": \"photo\",\n            \"orientation\": \"horizontal\",\n            \"safesearch\": true,\n            page,\n            per_page: pageLimit,\n        }\n    });\n\n    return response.data;\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst galleryListEl = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nexport const btnLoadMore = document.querySelector('.js-load-more');\n\n\nconst gallery = new SimpleLightbox('.gallery a', {\n   captionsData: 'alt',\n   captionDelay: 250,   \n});\n\nexport function createGallery(images) { \n    const imgGallery = images\n        .map(\n            ({\n                webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads,\n            }) => `\n            <li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img\n                    class=\"gallery-image\"\n                    src=\"${webformatURL}\"\n                    alt=\"${tags}\"\n                    />\n                </a>\n                <ul class=\"gallery-stat-list\">\n                    <li class=\"gallery-stat-item\">\n                        <p><b>Likes</b></p>\n                        <p>${likes}</p>\n                    </li>\n                    <li class=\"gallery-stat-item\">\n                        <p><b>Views</b></p>\n                        <p>${views}</p>\n                    </li>\n                    <li class=\"gallery-stat-item\">\n                        <p><b>Comments</b></p>\n                        <p>${comments}</p>\n                    </li>\n                    <li class=\"gallery-stat-item\">\n                        <p><b>Downloads</b></p>\n                        <p>${downloads}</p>\n                    </li>\n                </ul>\n            </li>\n            `)\n        .join(\"\");\n    \n    galleryListEl.insertAdjacentHTML(\"beforeend\", imgGallery);\n    gallery.refresh();\n}\n\n\nexport function clearGallery() {\n    galleryListEl.innerHTML = '';\n}\n\nexport function showLoader() {\n    loader.classList.add('loader');\n}\n\nexport function hideLoader() {\n    loader.classList.remove('loader');\n}\n\nexport function showLoadMoreButton() {\n  btnLoadMore.classList.remove('visually-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  btnLoadMore.classList.add('visually-hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n\nimport { getImagesByQuery, pageLimit, } from './js/pixabay-api';\nimport * as userRender from './js/render-functions';\n// import {\n//     btnLoadMore, \n//     clearGallery,\n//     createGallery,\n//     hideLoader,\n//     showLoader,\n//     hideLoadMoreButton,\n//     showLoadMoreButton,\n// } from './js/render-functions';\n\n\n// userRender.hideLoadMoreButton();\nuserRender.hideLoader();\n\n\nconst searchForm = document.querySelector('.form');\n\nlet currentPage = 1;\nlet searchQuery = '';\n\nsearchForm.addEventListener('submit', handleSubmit);\nuserRender.btnLoadMore.addEventListener('click', onLoadMore);\n\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    const form = event.target;\n    searchQuery = form.elements['search-text'].value.trim();\n    // console.log('searchQuery :' , searchQuery);    \n\n    if (!searchQuery.length) {\n        return iziToast.warning({\n            title: 'Caution',\n            message: 'Please enter your query!',\n            position: 'topRight',\n            timeout: 7000,\n        });\n    }\n\n    currentPage = 1;\n    userRender.clearGallery();\n    \n    userRender.hideLoadMoreButton();\n    userRender.showLoader();\n    \n\n    try {\n        const data = await getImagesByQuery(searchQuery, currentPage);\n\n        if (data.hits.length > 0) {\n            userRender.createGallery(data.hits);\n            // userRender.showLoadMoreButton();\n            userRender.hideLoader();\n            const totalPages = Math.ceil(data.totalHits / pageLimit);\n\n            if (currentPage >= totalPages) {\n                userRender.hideLoadMoreButton();\n                return iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    position: 'bottomRight',\n                    messageColor: \"#4e75ff\",\n                    backgroundColor: \"#F6FF00\",\n                    timeout: 7000,\n                });\n            } else {\n                userRender.showLoadMoreButton();\n            }\n        } else {\n            userRender.hideLoader();\n            return iziToast.info({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'center',\n                messageColor: \"#F6FF00\",\n                backgroundColor: \"#4e75ff\",\n                timeout: 7000,\n            });\n        }\n    } catch (error) {\n        iziToast.error({\n            message: 'Something went wrong! Please try new query!',\n            position: 'center',\n            timeout: 7000,\n        });\n        console.error('Error 2!!!', error);\n    } finally {\n        userRender.hideLoader();\n        form.reset();\n    }\n}\n\n\n\nasync function onLoadMore(event) {\n    currentPage++;\n    \n    userRender.hideLoadMoreButton();\n    userRender.showLoader();\n    userRender.btnLoadMore.disabled = true;\n\n    try {\n        const dataNextPage = await getImagesByQuery(searchQuery, currentPage);\n        userRender.createGallery(dataNextPage.hits);\n\n        userRender.hideLoader();\n        smoothScroll();\n\n        const totalPages = Math.ceil(dataNextPage.totalHits / pageLimit);\n\n        if (currentPage >= totalPages) {\n            userRender.hideLoadMoreButton();\n            return iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'bottomRight',\n                messageColor: \"#4e75ff\",\n                backgroundColor: \"#F6FF00\",\n                timeout: 7000,\n            });\n        } else {\n            userRender.showLoadMoreButton();\n            userRender.btnLoadMore.disabled = false;\n        }\n    } catch (error) {\n        userRender.hideLoader();\n        iziToast.error({\n            message: 'Something went wrong while loading more images!',\n            position: 'center',\n            timeout: 7000,\n        });\n        console.error('Error 1!!!', error);\n    } finally{\n        userRender.hideLoader();       \n    }\n}\n\nfunction smoothScroll() {\n    const galleryItem = document.querySelector('.gallery-stat-item');\n    if (galleryItem) {\n    // getBoundingClientRect() возвращает объект с размерами элемента\n    const itemHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n        top: itemHeight * 2,\n        behavior: 'smooth',\n    });\n  }\n}\n\n"],"names":["keyAPI","urlAPI","pageLimit","getImagesByQuery","query","page","axios","galleryListEl","loader","btnLoadMore","gallery","SimpleLightbox","createGallery","images","imgGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","userRender.hideLoader","searchForm","currentPage","searchQuery","handleSubmit","userRender.btnLoadMore","onLoadMore","event","form","iziToast","userRender.clearGallery","userRender.hideLoadMoreButton","userRender.showLoader","data","userRender.createGallery","totalPages","userRender.showLoadMoreButton","error","dataNextPage","smoothScroll","galleryItem","itemHeight"],"mappings":"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"}